# Практична робота №6 та Лабораторна робота № 6 "Алгоритм шифрування RSA"

**Мета роботи:** Практично освоїти алгоритм з відкритим ключем RSA. Здійснити вибір ключів і провести процедуру зашифрування-дешифрування повідомлень. Зробити програмне забезпечення.

## Стислі теоретичні відомості:

Ефективними системами криптографічного захисту даних є асиметричні криптосистеми (криптосистемами з відкритим ключем). У таких системах для шифрування даних використовується один ключ, а для дешифрування - інший (звідси й назва - асиметричні). Перший ключ є відкритим і може бути опублікований для використання всіма користувачами системи, які зашифровують дані. Дешифрування даних за допомогою відкритого ключа неможливо. Для дешифрування даних одержувач зашифрованої інформації використовує другий ключ, що є закритим (секретним). Зрозуміло, ключ дешифрування не може бути визначений із ключа шифрування. Узагальнена схема асиметричної криптосистеми з відкритим ключем показана на рис. 1. Генератор ключів доцільно розташовувати на стороні одержувача В (щоб не пересилати секретний ключ КВ по незахищеному каналу).

Рис. 1. Узагальнена схема асиметричної криптосистеми з відкритим ключем.

Алгоритм RSA запропонували в 1978 р. три автори: Р.Райвест (Rivest), А.Шамир (Shamir) і А.Адлеман (Adleman). Алгоритм одержав свою назву по перших літерах їх прізвищ. Алгоритм RSA став першим повноцінним алгоритмом з відкритим ключем, що може працювати як у режимі шифрування даних, так і в режимі електронного цифрового підпису. Надійність алгоритму ґрунтується на важкості факторизації великих чисел та важкості обчислення дискретних логарифмів.

### Алгоритм створення відкритого і секретного ключів

RSA-ключі генеруються таким чином:

1.  Вибираються два випадкових простих числа _p_ і _q_ заданого розміру (наприклад, 1024 біта кожне).

2.  Обчислюється їх добуток _n = p_ _ q_, яке називається модулем.

3.  Обчислюється значення функції Ейлера від числа n: φ(n) = (p-1) \* (q-1).

4.  Вибирається ціле число _e_, взаємнопросте із значенням функції Ейлера. Зазвичай за _e_ беруть прості числа, що містять невелику кількість одиничних бітів в двійковій запису, наприклад, прості числа Ферма 17, 257, або 65 537. Число _e_ називається відкритою експонентою (англ. public exponent). Час, необхідний для шифрування з використанням швидкого піднесення до степеня, пропорційно числу одиничних біт в _e_. Занадто малі значення _e_, наприклад 3, потенційно можуть послабити безпеку схеми RSA.

5.  Обчислюється число _d_, мультиплікативно зворотне до числа _e_ по модулю φ(n):

    `de mod φ(n) = 1`

    Число _d_ називається секретною експонентою. Зазвичай, воно обчислюється за допомогою розширеного алгоритму Евкліда або за допомогою ланцюгових дробів.

6.  Пара _KU = {e, n}_ відіграє роль відкритого ключа RSA (англ. RSA public key).

7.  Пара _KR = {d, n}_ публікується в якості відкритого ключа RSA (англ. RSA private key) і тримається в секреті.

Повідомлення перед шифруванням необхідно розбити на блоки - числа від 0 до n – 1.
Шифрування та дешифрування даних здійснюються в такий спосіб:

- Шифрування: `C = m^e mod n`, де _m_ - блок відкритого тексту.
- Дешифрування: `m = C^d mod n`.

Слід також зазначити, що ключі _e_ і _d_ рівноправні, тобто повідомлення можна шифрувати як ключем _e_, так і ключем _d_, при цьому розшифрування повинне бути зроблене за допомогою іншого ключа.

**ЗАВДАННЯ**. Необхідно зашифрувати перші чотири літери прізвища, імені та по батькові студента (латиницею) за допомогою алгоритму RSA для передачі абоненту В. Параметри алгоритму RSA: p, q – представлені у додатку 3, е вибрати самостійно.

Необхідно також обчислити закритий ключ і розшифрувати шифротекст.

## Хід роботи

**Вихідні дані:**

ПІБ студента : Артеменко Андрій Олександрович;
Літери для шифрування: arte;
Параметри алгоритму RSA:
p = 23
q = 53
е = 17 (вибрано самостійно, оскільки gcd(17, (23-1)\*(53-1)) = gcd(17, 1144) = 1)

**Кодування ASCII**

Перетворимо літери у десятковий код за таблицею ASCII:
a = 97
r = 114
t = 116
e = 101

**Обчислення параметрів RSA**

n = p _ q = 23 _ 53 = 1219
Відкритий ключ: KU ={e,n} ={17, 1219}

**Шифрування (формула: c = m^e mod n)**

С1 = 97 ^ 17 mod 1219 = 360
С2 = 114 ^ 17 mod 1219 = 1034
С3 = 116 ^ 17 mod 1219 = 990
С4 = 101 ^ 17 mod 1219 = 624

**Шифрований текст, переданий абоненту В:**

360, 1034, 990, 624

**Обчислення закритого ключа**

Функція Ейлера: ф(n) = (p-1) _ (q-1) = (23-1) _ (53-1) = 22 \* 52 = 1144
Закритий ключ d: d = e ^ (-1) mod ф(n) = 17^(-1) mod 1144 = 673

**Дешифрування (формула: m = c^d mod n)**

M1 = 360 ^ 673 mod 1219 = 97
M2 = 1034 ^ 673 mod 1219 = 114
M3 = 990 ^ 673 mod 1219 = 116
M4 = 624 ^ 673 mod 1219 = 101

**Отримане повідомлення (ASCII):** 97, 114, 116, 101

**Розшифроване слово:** arte.
